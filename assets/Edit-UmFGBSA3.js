function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/editor-dark-BRKhganV.css","assets/editor-light-D26CY3n5.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{_ as V,i as I}from"./index-ml26JNDG.js";import{T as B,a as T}from"./@toast-ui-ByfNNsDZ.js";import{P as S}from"./prismjs-fI4MQPZ2.js";import{l as U}from"./ThemeStorage-CW_JtCbm.js";import{j as w,K as C,H as N,w as M,o as b,c as P,q as g,U as L,e as q,Z as n,f as s,Y as _,t as k,a as x}from"./@vue-CZiqxx0s.js";import{u as A}from"./vue-router-BlgSFk1T.js";import{b as D,u as R}from"./GournalApi-B6VOsD3x.js";import{a as j}from"./axios-Cm0UX6qg.js";import{D as H,E as O,l as z,t as y,F as G,j as $,V as F,G as K}from"./vuetify-Cwe4HWZu.js";/* empty css             */import"./@date-io-BFoq4MFi.js";import"./dayjs-B2CR7XcO.js";import"./prosemirror-model-DfrscQcC.js";import"./orderedmap-C4TimWWB.js";import"./prosemirror-view-C8GFL5qc.js";import"./prosemirror-state-QVoFbwxj.js";import"./prosemirror-transform-Cg2yShc_.js";import"./prosemirror-keymap-C5wSqEO9.js";import"./w3c-keyname-DEtA-KhA.js";import"./prosemirror-commands-DBoMJ0a0.js";import"./prosemirror-inputrules-COeJEC4j.js";import"./prosemirror-history-KEdM-JI1.js";import"./rope-sequence-Cxv9J64N.js";const W={id:"editor",class:"h-100",style:{"background-color":"#344955"}},Y=w({__name:"Editor",props:{modelValue:{type:String,required:!0,default:""}},emits:["update:modelValue","change","uploadImage"],setup(i,{emit:u}){const t=i,o=u;let a=null;C(()=>{const e=U()==="dark";e?V(()=>Promise.resolve({}),__vite__mapDeps([0])):V(()=>Promise.resolve({}),__vite__mapDeps([1])),a=new B({el:document.querySelector("#editor"),initialEditType:"markdown",previewStyle:"vertical",hideModeSwitch:!0,placeholder:"Write your gournal...",usageStatistics:!1,initialValue:t.modelValue,autofocus:!0,theme:e?"dark":"default",events:{change:()=>{o("update:modelValue",a.getMarkdown()),o("change",a.getMarkdown())}},hooks:{addImageBlobHook:d},toolbarItems:[["heading","bold","italic","strike"],["hr","quote"],["ul","ol","task","indent","outdent"],["table","image","link"],["code","codeblock"]],plugins:[[T,{highlighter:S}]]}),f()});function d(e,l){o("uploadImage",e,l)}N(()=>{a.destroy()}),M(()=>t.modelValue,e=>{a.getMarkdown()!==e&&a.setMarkdown(e)});function f(){if(document.getElementsByClassName("toastui-editor-defaultUI")[0]){const l="toastui-editor-background",c=document.getElementsByClassName("toastui-editor-defaultUI-toolbar")[0],p=document.getElementsByClassName("toastui-editor-md-container")[0];c==null||c.classList.add(l),p==null||p.classList.add(l)}}return(e,l)=>(b(),P("div",W))}}),Z=async i=>{const u={fileName:i.name},t=await I.post("/images/presigned-url",u),o=new URL(t.url);return j.put(o.toString(),i,{headers:{"Content-Type":i.type,"x-amz-acl":"public-read"}}).then(()=>o.pathname)},J=x("b",null,"-",-1),Q={class:"text-truncate"},we=w({__name:"Edit",setup(i){const u=A(),t=g({}),o=g(""),a=g(!0),d=g(!1);let f=null;L(()=>{D(Number(u.currentRoute.value.params.id)).then(r=>{t.value=r,o.value=r.text??""})});function e(){a.value||R({id:t.value.id,text:o.value}).then(r=>{a.value=!0,t.value=r})}function l(){e(),u.replace("/pages")}function c(r){a.value=!1,clearTimeout(f),f=setTimeout(e,1e3*.5)}async function p(r,m){d.value=!0,Z(r).then(h=>{m("https://sgp1.vultrobjects.com/gournal"+h,r.name)}).finally(()=>{d.value=!1})}function E(){window.open(t.value.url,"_blank")}return(r,m)=>{const h=Y;return b(),q(K,{class:"h-100 rounded rounded-md"},{default:n(()=>[s(O,{modelValue:d.value,"onUpdate:modelValue":m[0]||(m[0]=v=>d.value=v),class:"d-flex justify-center align-center"},{default:n(()=>[s(H,{size:100,width:10,color:"info",indeterminate:""})]),_:1},8,["modelValue"]),s($,{color:"black"},{default:n(()=>[s(z,{onClick:E,class:"cursor-pointer"},{default:n(()=>[s(y,null,{default:n(()=>[_("mdi-github")]),_:1}),_(" "+k(t.value.repositoryName)+" ",1),J,_(),x("span",Q,k(t.value.message),1)]),_:1}),s(G,{class:"mr-5",onClick:l},{default:n(()=>[s(y,null,{default:n(()=>[_("mdi-arrow-left")]),_:1})]),_:1})]),_:1}),s(F,null,{default:n(()=>[s(h,{modelValue:o.value,"onUpdate:modelValue":m[1]||(m[1]=v=>o.value=v),class:"h-100 w-100",onChange:c,onUploadImage:p},null,8,["modelValue"])]),_:1})]),_:1})}}});export{we as default};

import{r as I,f as N,M as _,a as L,h as q,i as F}from"./ProgramStatusCombobox-b7c7027e.js";import{b as U,c as K,S as O,E as j,P as A,V as H,a as J,d as W}from"./VTable-effef9c8.js";import{e as z,V as G,a as Q}from"./VTextField-bdf6a346.js";import{d as T,N as f,f as R,o as g,$ as B,a as t,w as l,_ as X,V as k,a2 as w,a3 as $,a0 as b,a4 as Y,k as Z,r as y,c as C,b as r,W as S,R as x,a1 as ee,e as te}from"./index-f320d07b.js";import{_ as P,e as D,d as E,b as M,c as le}from"./index-d59e3ac5.js";import{b as ae,c as oe}from"./VToolbar-d997f552.js";import{P as se}from"./PrepareProgramModal-d7298486.js";import{E as ne}from"./ExerciseTemplateModal-0ae598c6.js";import{V as ie}from"./VPagination-d57b32b1.js";const re=T({name:"InviteClientModal",props:{dialog:{type:Boolean,default:!1}},data:e=>({emailRules:z(e.t)}),emits:["close"],setup(e,a){const u=f(!1),c=f(N()),d=f(),p=f(),{t:o}=R();return{request:c,loading:u,register:async()=>{const{valid:i}=await p.value.validate();i&&(d.value="",u.value=!0,I(c.value).then(m=>{var n;m.success?a.emit("close"):((n=m==null?void 0:m.error)==null?void 0:n.type)=="NOT_FOUND_CLIENT"&&(d.value=o("$vuetify.inviteClientModal.clientNotFound"))}).finally(()=>{u.value=!1}))},errorMessage:d,formRefs:p,t:o}}}),ue={class:"text-center"};function de(e,a,u,c,d,p){return g(),B("div",ue,[t(K,{persistent:"",scrollable:"",modelValue:e.dialog,"onUpdate:modelValue":a[4]||(a[4]=o=>e.dialog=o),width:"420"},{default:l(()=>[t(G,{ref:"formRefs",onSubmit:a[3]||(a[3]=X(()=>{},["prevent"]))},{default:l(()=>[t(D,{loading:e.loading,elevation:"10"},{default:l(()=>[t(ae,{color:"secondary",density:"compact"},{default:l(()=>[t(oe,{class:"font-weight-bold"},{default:l(()=>[t(k,{loading:e.loading,icon:"",onClick:a[0]||(a[0]=o=>e.$emit("close"))},{default:l(()=>[t(w,null,{default:l(()=>[$("mdi-close")]),_:1})]),_:1},8,["loading"]),$(" "+b(e.t("$vuetify.inviteClientModal.title")),1)]),_:1}),t(U,null,{default:l(()=>[t(k,{loading:e.loading,icon:"",onClick:e.register},{default:l(()=>[t(w,null,{default:l(()=>[$("mdi-account-plus")]),_:1})]),_:1},8,["loading","onClick"])]),_:1})]),_:1}),t(E,null,{default:l(()=>[t(Q,{modelValue:e.request.email,"onUpdate:modelValue":a[1]||(a[1]=o=>e.request.email=o),color:"secondary",clearable:"",variant:"outlined",rules:e.emailRules,"error-messages":e.errorMessage,onKeyup:[a[2]||(a[2]=o=>e.errorMessage=""),Y(e.register,["enter"])],label:e.t("$vuetify.common.email")},null,8,["modelValue","rules","error-messages","onKeyup","label"])]),_:1})]),_:1},8,["loading"])]),_:1},512)]),_:1},8,["modelValue"])])}const me=P(re,[["render",de]]),fe=T({name:"MembershipList",computed:{MembershipStatus(){return _}},components:{SearchTextField:O,ExerciseTemplateModal:ne,PrepareProgramModal:se,InviteClientModal:me,EditButton:j,PlusButton:A,MemberProfile:L},props:{title:{type:String,required:!0},showRegisterButton:{type:Boolean,default:!1},memberships:{type:Object,required:!0}},emits:["search","click:item"],setup(e,a){const u=f(!1),c=f([]),d=f(e.memberships),{t:p}=R(),o=f(!1),h=()=>{u.value=!1,i(1)},i=s=>{a.emit("search",s-1)},m=s=>{s&&s.length>0?a.emit("search",0,s):i(1)},n=(s,v)=>{o.value=!0,s.membershipStatus!=v&&(v===_.APPROVED?q(s.id).then(V=>{V.success&&i(1)}).finally(()=>{o.value=!1}):v===_.REJECTED&&F(s.id).then(V=>{V.success&&i(1)}).finally(()=>{o.value=!1}))};return Z(()=>e.memberships,s=>{c.value=s.content,d.value=s},{deep:!0}),{inviteDialog:u,closeInviteModal:h,changeStatus:n,pageSearch:i,keywordSearch:m,contents:c,pagination:d,t:p,loading:o}}}),ce={class:"pr-5"},pe={class:"text-subtitle-1 font-weight-bold"},ge={class:"text-subtitle-1 font-weight-bold"},ve=["onClick"];function be(e,a,u,c,d,p){const o=y("plus-button"),h=y("invite-client-modal"),i=y("search-text-field"),m=y("member-profile");return g(),C(D,{loading:e.loading,elevation:"10"},{default:l(()=>[t(M,{class:"pa-6"},{default:l(()=>[t(le,{class:"text-h5 pt-sm-2 pb-7"},{default:l(()=>[r("span",ce,b(e.title),1),e.showRegisterButton?(g(),C(o,{key:0,onClick:a[0]||(a[0]=n=>e.inviteDialog=!0)})):S("",!0),e.inviteDialog?(g(),C(h,{key:1,dialog:e.inviteDialog,onClose:e.closeInviteModal},null,8,["dialog","onClose"])):S("",!0)]),_:1}),t(E,null,{default:l(()=>[t(i,{label:e.t("$vuetify.membershipList.nickNameOrEmail"),onSearch:e.keywordSearch},null,8,["label","onSearch"])]),_:1}),t(M,null,{default:l(()=>[t(H,null,{default:l(()=>[r("thead",null,[r("tr",null,[r("th",pe,b(e.t("$vuetify.membershipList.profile")),1),r("th",ge,b(e.t("$vuetify.common.status")),1)])]),r("tbody",null,[(g(!0),B(x,null,ee(e.contents,n=>(g(),C(J,{key:n.id},{default:l(({isHovering:s,props:v})=>[r("tr",te(v,{class:s?"clickable-hover":"",onClick:V=>e.$emit("click:item",n)}),[r("td",null,[t(m,{member:n==null?void 0:n.member},null,8,["member"])]),r("td",null,[t(W,{color:"third"},{default:l(()=>[$(b(n.membershipStatus),1)]),_:2},1024)])],16,ve)]),_:2},1024))),128))])]),_:1})]),_:1}),t(M,null,{default:l(()=>[t(ie,{length:e.pagination.totalPages,"total-visible":"5","onUpdate:modelValue":e.pageSearch},null,8,["length","onUpdate:modelValue"])]),_:1})]),_:1})]),_:1},8,["loading"])}const Se=P(fe,[["render",be]]);export{Se as M};
